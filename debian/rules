#!/usr/bin/make -f

PACKAGE=$(shell dh_listpackages)

export DH_VIRTUALENV_ARGUMENTS=--python python3 --system-site-packages
export DH_VIRTUALENV_INSTALL_ROOT=/usr/lib

%:
	dh $@ --buildsystem=dh_virtualenv

override_dh_auto_clean:
	dh_auto_clean
	make -rf configure.mk clean

override_dh_auto_configure:
	make -rf configure.mk prefix=/usr libexecdir=/usr/lib sysconfdir=/etc localstatedir=/var pkglocalstatedir=/var/lib/$(PACKAGE) runstatedir=/run
	dh_auto_configure

override_dh_auto_install:
	dh_auto_install
	# Move console scripts to /usr/bin
	mkdir -p debian/$(PACKAGE)/usr/bin
	mv debian/$(PACKAGE)/usr/lib/$(PACKAGE)/bin/hades-* debian/$(PACKAGE)/usr/bin

override_dh_builddeb:
	dh_builddeb -- -Zgzip -z3
