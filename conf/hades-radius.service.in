[Unit]
Description=Hades RADIUS service (FreeRADIUS)
Documentation=https://agdsn.github.io/hades/
After=hades-database.service
After=hades-root-netns.service
BindsTo=hades-root-netns.service
Wants=hades-database.service

[Service]
Type=forking
PIDFile=@RADIUS_PID_FILE@
SyslogIdentifier=hades-radius
User=@RADIUS_USER@
Group=@RADIUS_GROUP@
Environment=PGAPPNAME=hades-radius
EnvironmentFile=@systemdenvfile@
ExecStartPre=@bindir@/hades-generate-config freeradius @pkgrunstatedir@/radius
ExecStartPre=@TOUCH@ @RADIUS_CLIENTS_FILE@
ExecStartPre=@RADIUSD@ -d @pkgrunstatedir@/radius -Cx -lstdout
ExecStart=@RADIUSD@ -d @pkgrunstatedir@/radius $FREERADIUS_OPTS
ExecReload=@bindir@/hades-generate-config freeradius @pkgrunstatedir@/radius
ExecReload=@KILL@ -HUP $MAINPID
Restart=always
RestartSec=5
;RuntimeDirectoryPreserve is not yet supported on Stretch's systemd
;RuntimeDirectory=hades/radius
;RuntimeDirectoryMode=2750
;RuntimeDirectoryPreserve=yes

[Install]
WantedBy=hades.target
